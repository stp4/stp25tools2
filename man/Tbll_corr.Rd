% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tbll-corr.R
\name{Tbll_corr}
\alias{Tbll_corr}
\title{Correlation Table Generator}
\usage{
Tbll_corr(
  ...,
  include.label = TRUE,
  include.mean = FALSE,
  include.n = TRUE,
  include.stars = TRUE,
  include.p = FALSE,
  cor_diagonale_up = TRUE,
  type = c("pearson", "spearman")
)
}
\arguments{
\item{...}{Formula specification or data. Supports three formats:
\itemize{
  \item \code{~ a + b + c}: Creates correlation matrix of variables a, b, c
  \item \code{a ~ b}: Correlates variable a with variable b
  \item \code{a + b + c ~ d}: Correlates variables a, b, c with variable d
}}

\item{include.label}{Logical. If TRUE, includes variable labels in output.
Default is TRUE.}

\item{include.mean}{Logical. If TRUE, includes means and standard deviations
in correlation matrix. Default is FALSE.}

\item{include.n}{Logical. If TRUE, includes sample sizes for each correlation.
Default is TRUE.}

\item{include.stars}{Logical. If TRUE, adds significance stars to correlations
(*** p<0.001, ** p<0.01, * p<0.05, . p<0.1). Default is TRUE.}

\item{include.p}{Logical. If TRUE, includes explicit p-values instead of or
in addition to significance stars. Default is FALSE.}

\item{cor_diagonale_up}{Logical. For correlation matrices, if TRUE shows
correlations in upper triangle, if FALSE in lower triangle. Default is TRUE.}

\item{type}{Character. Correlation method, either "pearson" or "spearman".
Default is "pearson".}
}
\value{
A tibble containing the formatted correlation results with the following
possible columns depending on the input format:
\itemize{
  \item For matrices: Source (variable names), numbered columns with correlations
  \item For grouped correlations: Characteristics, N, r, p.value (with group prefixes)
  \item Correlations are formatted to 2 decimal places
  \item P-values: <.001, .001-.01 (3 decimals), >.01 (2 decimals)
}
}
\description{
R functions for creating formatted correlation tables with various options
}
\details{
The function uses Hmisc::rcorr() for correlation calculations, which handles
missing values using pairwise deletion. For correlation matrices, the diagonal
can be displayed in the upper or lower triangle for better readability.

Significance levels: *** p<0.001, ** p<0.01, * p<0.05, . p<0.1
}
\note{
Enhanced version with improved error handling, documentation, and code structure
}
\section{Inspiration and Related Packages}{

This script builds upon correlation analysis concepts from:
\itemize{
  \item \strong{Hmisc} (\url{https://cran.r-project.org/package=Hmisc}):
    Frank Harrell's comprehensive statistics package with rcorr() function
  \item \strong{corrr} (\url{https://github.com/tidymodels/corrr}):
    Tidy correlation matrices and network plots
  \item \strong{psych} (\url{https://cran.r-project.org/package=psych}):
    Procedures for personality, psychometric, and psychological research
  \item \strong{corrplot} (\url{https://github.com/taiyun/corrplot}):
    Visualization of correlation matrices
}


Create Formatted Correlation Table

This function creates publication-ready correlation tables with flexible formatting
options. It supports correlation matrices, grouped correlations, and conditional
correlations using the Hmisc::rcorr() function as backend.
}

\examples{
# Create sample data
set.seed(1)
n <- 40
dat <- data.frame(
  group = gl(2, 20, labels = c("Control", "Treat")),
  a = rnorm(n, 0, 1),
  b = rnorm(n, 0, 1),
  c = rnorm(n, 0, 1),
  d = rnorm(n, 0, 0.5) + rnorm(n, 0, 1)
)

# Correlation matrix
Tbll_corr(~ a + b + c, dat)

# Single correlation
Tbll_corr(a ~ c, dat)

# Multiple correlations with one variable
Tbll_corr(a + b + c ~ d, dat)

# With custom options
Tbll_corr(~ a + b + c, dat,
         include.mean = TRUE,
         include.stars = FALSE,
         include.p = TRUE,
         type = "spearman")

}
\seealso{
\code{\link[Hmisc]{rcorr}}, \code{\link[stats]{cor}}, \code{\link[stats]{cor.test}}
}
\author{
Improved with assistance from Claude Sonnet 4 (claude-sonnet-4-20250514)
}
